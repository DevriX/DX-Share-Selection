!function(w){w.fn.selectedTextSharer=function(e){let o=0<=window.location.href.indexOf("dx-share-selection")&&0<=window.location.href.indexOf("wp-admin");e=w.extend({title:"Share",lists:"Google,http://www.google.com/search?q=%s",borderColor:"#7a7a7a",background:"#aaaaaa",titleColor:"#f2f2f2",titleTextColor:"#000",hoverColor:"#ffffcc",textColor:"#000",extraClass:"",truncateChars:115},e);let s=[],n=[];function p(){return window.getSelection?selectionTxt=window.getSelection():document.getSelection?selectionTxt=document.getSelection():document.selection&&(selectionTxt=document.selection.createRange().text),selectionTxt}function t(){var t;!function(){for(s=e.lists.split("|"),i=0;i<s.length;i++)n[i]=s[i].split(",")}(),t=t||window.event,stsBox='<div class="stsBox'+(e.extraClass?" "+e.extraClass:"")+'"><div class="title">'+e.title+'</div><div class="list"><ul></ul></div></div>',w("body > .stsBox ").remove(),w("body").append(stsBox),function(){for(stsBoxEle=w("body").find(".stsBox"),i=0;i<s.length;i++)null!=n[i][0]&&(img=null!=n[i][2]?(iconUrl=n[i][2].split(" ").join(""),"favicon"==iconUrl?'<img src="'+(-1!=(t=n[i][1]).indexOf(".")&&-1!=t.indexOf("/")&&t.substr(0,t.indexOf("/",t.indexOf("."))+1))+'favicon.ico" width="16" height="16" alt="'+n[i][0]+'"/> ':'<img src="'+n[i][2]+'" width="16" height="16" alt="'+n[i][0]+'"/> '):"",t=o?"":'rel="'+n[i][1]+'"',tempList="<li>"+img+"<a "+t+' title="'+n[i][0]+'" href="#">'+n[i][0]+"</a></li>",stsBoxEle.find("ul").append(tempList));var t}(),stsBoxEle=w("body").find(".stsBox"),o?stsBoxEle.css({display:"block",overflow:"hidden",border:"1px solid "+e.borderColor,"white-space":"nowrap","font-family":"sans-serif",background:"#aaaaaa",color:"#333","border-radius":"5px",padding:0}):stsBoxEle.css({display:"none","z-index":999999999,position:"absolute",overflow:"hidden",border:"1px solid "+e.borderColor,"white-space":"nowrap","font-family":"sans-serif",background:"#aaaaaa",color:"#333","border-radius":"5px",padding:0}),stsBoxEle.find("img").css({"vertical-align":"middle"}),stsBoxEle.find(".title").css({color:e.titleTextColor,background:e.titleColor,padding:"10px","border-bottom":"1px solid #e5e5e5"}),stsBoxEle.find(".title").find("a").css({float:"right","padding-left":"5","padding-right":"5"}),stsBoxEle.find("a").css({color:e.textColor,"text-decoration":"none"}),stsBoxEle.find(".list").css({background:e.background,padding:"3px"}),w(".stsBox ul, .stsBox li").css({padding:"2px",cursor:"pointer","list-style-type":"none",transition:"all .3s ease","user-select":"none","margin-bottom":"5px","border-radius":"2px"}),w(".stsBox ul, .stsBox li img").css({"margin-bottom":"3px"}),w(".stsBox li:hover").css({"background-color":"#DEF"}),w(".stsBox li").css({padding:"3px 7px"}),stsBoxEle.find("li").hover(function(){w(this).css({background:e.hoverColor})},function(){w(this).css({background:"none"})})}return String.prototype.trunc=function(t){return this.substr(0,t-1)+(this.length>t?"...":"")},this.each(function(){t(w(this)),w(this).mouseup(function(n){if(!w(n.target).closest(".stsBox").length&&""!=p()){stsBoxEle=w("body").find(".stsBox");var l=n.pageX,r=n.pageY;let t=window.getSelection(),e=t.getRangeAt(0);var a=e.getBoundingClientRect(),d=w(window).height(),c=w(window).width(),x=d-(d-r+stsBoxEle.outerHeight()+20),f=c-(l+stsBoxEle.outerWidth()+10);let o=0,s=0;o=0<=x?r-15-(stsBoxEle.outerHeight()+w(".stsBox li a").length):r+15,s=0<=f?l+15:l-Math.abs(f);var u=o,g=o+stsBoxEle.outerHeight(),h=s,n=s+stsBoxEle.outerWidth(),c=a.top+window.scrollY,l=a.bottom+window.scrollY,f=a.left+window.scrollX,a=a.right+window.scrollX;let i=f<h&&h<a||f<n&&n<a||h<f&&a<n?!0:!1;i&&(o=g<l&&c<g?!(u<l&&c<u)||r-c<l-r?c-15-(stsBoxEle.outerHeight()+w(".stsBox li a").length):l+15:!(u<l&&c<u)&&r-c<l-r?c-15-(stsBoxEle.outerHeight()+w(".stsBox li a").length):l+15),d-(d-o+window.scrollY)<0&&(o=i?l+15:r+15),stsBoxEle.css({top:o,left:s}),stsBoxEle.fadeIn("fast"),w(".stsBox li a").each(function(){w(this).attr("rev",p())})}}),w("img").on("error",function(t){t.target.style.display="none"}),o||(w(".stsBox li").on("click",function(){sUrl=w(this).children("a").attr("rel"),selectedText=w(this).children("a").attr("rev"),theUrl=sUrl.replace("%s",selectedText),theUrl=theUrl.replace("%ts",selectedText.trunc(e.truncateChars)),window.open(theUrl,"sts_window")}),w(document).on("mousedown",function(t){w(t.target).closest(".stsBox").length||w(".stsBox").fadeOut("fast")}),w(window).on("blur",function(t){w(".stsBox").fadeOut("fast")}))})}}(jQuery);