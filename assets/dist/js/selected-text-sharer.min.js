!function(h){h.fn.selectedTextSharer=function(e){var e=h.extend({title:"Share",lists:"Google,http://www.google.com/search?q=%s",truncateChars:115,extraClass:"",borderColor:"#444",background:"#fff",titleColor:"#f2f2f2",hoverColor:"#ffffcc",textColor:"#000",titleTextColor:"#000"},e),o=[],s=[];function f(){return window.getSelection?selectionTxt=window.getSelection():document.getSelection?selectionTxt=document.getSelection():document.selection&&(selectionTxt=document.selection.createRange().text),selectionTxt}function t(){var t;!function(){for(o=e.lists.split("|"),i=0;i<o.length;i++)s[i]=o[i].split(",")}(),t=t||window.event,stsBox='<div class="stsBox '+e.extraClass+'"><div class="title">'+e.title+'</div><div class="list"><ul></ul></div><span class="arrow"></span></div>',h("body > .stsBox ").remove(),h("body").append(stsBox),function(){for(stsBoxEle=h("body").find(".stsBox"),i=0;i<o.length;i++)null!=s[i][0]&&(img=null!=s[i][2]?(iconUrl=s[i][2].split(" ").join(""),"favicon"==iconUrl?'<img src="'+(-1!=(t=s[i][1]).indexOf(".")&&-1!=t.indexOf("/")&&t.substr(0,t.indexOf("/",t.indexOf("."))+1))+'favicon.ico" width="16" height="16" alt="'+s[i][0]+'"/> ':'<img src="'+s[i][2]+'" width="16" height="16" alt="'+s[i][0]+'"/> '):"",tempList="<li>"+img+'<a rel="'+s[i][1]+'" title="'+s[i][0]+'" href="#">'+s[i][0]+"</a></li>",stsBoxEle.find("ul").append(tempList));var t}(),stsBoxEle=h("body").find(".stsBox"),stsBoxEle.css({display:"none","z-index":200,position:"absolute",overflow:"hidden",border:"1px solid "+e.borderColor,"white-space":"nowrap","font-family":"sans-serif",background:"#FFF",color:"#333","border-radius":"5px",padding:0}),stsBoxEle.find("img").css({"vertical-align":"middle"}),stsBoxEle.find(".title").css({color:e.titleTextColor,background:e.titleColor,padding:"10px","border-bottom":"1px solid #e5e5e5"}),stsBoxEle.find(".title").find("a").css({float:"right","padding-left":"5","padding-right":"5"}),stsBoxEle.find("a").css({color:e.textColor,"text-decoration":"none"}),stsBoxEle.find(".list").css({background:e.background,padding:"7px"}),h(".stsBox ul, .stsBox li").css({padding:"2px",cursor:"pointer","list-style-type":"none",transition:"all .3s ease","user-select":"none","margin-bottom":"5px"}),h(".stsBox ul, .stsBox li img").css({"margin-bottom":"3px"}),h(".stsBox li:hover").css({"background-color":"#DEF"}),h(".stsBox li").css({padding:"3"}),stsBoxEle.find(".arrow").css({width:0,height:0,"line-height":0,"border-left":"10px solid transparent","border-top":"15px solid "+e.borderColor,position:"absolute",bottom:"-19px"}),stsBoxEle.find("li").hover(function(){h(this).css({background:e.hoverColor})},function(){h(this).css({background:"none"})})}return String.prototype.trunc=function(t){return this.substr(0,t-1)+(this.length>t?"...":"")},this.each(function(){t(h(this)),h(this).mouseup(function(l){if(!h(l.target).closest(".stsBox").length&&""!=f()){stsBoxEle=h("body").find(".stsBox");var n=l.pageX,r=l.pageY;let t=window.getSelection(),e=t.getRangeAt(0);var d=e.getBoundingClientRect(),c=h(window).height(),a=h(window).width(),x=stsBoxEle.outerHeight(),g=a-(n+stsBoxEle.outerWidth()+10);let o=0,s=0;o=0<=c-(c-r+x+20)?r-20-(stsBoxEle.outerHeight()+h(".stsBox li a").length):r+20,s=0<=g?n+20:n-Math.abs(g);var u=o,l=o+stsBoxEle.outerHeight(),a=s,c=s+stsBoxEle.outerWidth(),x=d.top+window.scrollY,n=d.bottom+window.scrollY,g=d.left+window.scrollX,d=d.right+window.scrollX;let i=g<a&&a<d||g<c&&c<d||a<g&&d<c?!0:!1;i&&(o=l<n&&x<l?!(u<n&&x<u)||r-x<n-r?x-5-(stsBoxEle.outerHeight()+h(".stsBox li a").length):n+10:!(u<n&&x<u)&&r-x<n-r?x-5-(stsBoxEle.outerHeight()+h(".stsBox li a").length):n+10),stsBoxEle.css({top:o,left:s}),stsBoxEle.fadeIn("fast"),h(".stsBox li a").each(function(){h(this).attr("rev",f())})}}),h(".stsBox li").click(function(){sUrl=h(this).children("a").attr("rel"),selectedText=h(this).children("a").attr("rev"),theUrl=sUrl.replace("%s",selectedText),theUrl=theUrl.replace("%ts",selectedText.trunc(e.truncateChars)),window.open(theUrl,"sts_window")}),h("img").on("error",function(t){t.target.style.display="none"}),h(document).mousedown(function(t){h(t.target).closest(".stsBox").length||h(".stsBox").fadeOut("fast")}),h(window).blur(function(t){h(".stsBox").fadeOut("fast")})})}}(jQuery);